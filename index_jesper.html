<!DOCTYPE html>
<div id="container"></div>

<script src="d3.v7.js"></script>
<script type="module">  
  var margin = { top: 50, right: 50, bottom: 50, left: 40 },
    width = 500 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;
  
  var x = d3.scaleBand().range([0, width]).padding(0.3);
  var y = d3.scaleLinear().range([height, 0]);
  
  var svg = d3.select("body")
    .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  
  // Specify the desired IDs to include in the plot
  var desiredIDs = ['3', '4', '5'];

  // Title for the bar chart
  svg.append("text")
      .attr("x", width / 2 -10)
      .attr("y", height * 1.1)
      .attr("text-anchor", "middle")
      .style("font-size", "18px")
      .style("font-family", "Helvetica")
      .style("font-weight", "bold")  // Add bold style
      .text("Overtakes Count for Selected IDs");

  d3.csv("data/overtakes.csv").then(function (data) {
    data.forEach(function (d) {
        d.Overtakes = +d.Overtakes;
    });

    // Filter data based on desired IDs
    var filteredData = data.filter(function (d) {
        return desiredIDs.includes(d.ID);
    });

    // Count races in each category
    var raceCounts = {
        '0-24': 0,
        '25-49': 0,
        '50-75+': 0
    };
  
    filteredData.forEach(function (d) {
        if (d.Overtakes >= 0 && d.Overtakes <= 24) {
            raceCounts['0-24']++;
        } else if (d.Overtakes >= 25 && d.Overtakes <= 49) {
            raceCounts['25-49']++;
        } else {
            raceCounts['50-75+']++;
        }
    });
  
    // Create an array of objects for the bar chart
    var barData = Object.keys(raceCounts).map(function (key) {
        return { category: key, count: raceCounts[key] };
    });

    // Define a custom color for the bars
    var barColor = d3.scaleOrdinal()
        .domain(barData.map(function (d) { return d.category; }))
        .range(["#FF00FF", "#FF00FF", "#FF00FF"]);

    x.domain(barData.map(function (d) { return d.category; }));
    y.domain([0, d3.max(barData, function (d) { return d.count; })]);
  
    svg.selectAll(".bar")
        .data(barData)
        .enter().append("rect")
        .attr("class", "bar")
        .attr("x", function (d) { return x(d.category); })
        .attr("width", x.bandwidth())
        .attr("y", function (d) { return y(d.count); })
        .attr("height", function (d) { return height - y(d.count); })
        .attr("fill", function (d) { return barColor(d.category); });

    svg.append("g")
        .attr("transform", "translate(0," + height + ")")
        .call(d3.axisBottom(x));
  
    svg.append("g")
        .call(d3.axisLeft(y));
  
    // Adjust font size for x-axis tick labels
    svg.selectAll(".tick text")
        .style("font-size", "15px");
  });
</script>
<script type="module">  
var margin = { top: 50, right: 50, bottom: 50, left: 40 },
    width = 500 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

var x = d3.scaleBand().range([0, width]).padding(0.3);
var y = d3.scaleLinear().range([height, 0]);

var svg = d3.select("body")
    .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

// Specify the desired IDs to include in the plot
var desiredIDs = ['860', '861', '862', '863', '864', '865'];

// Title for the bar chart
svg.append("text")
    .attr("x", width / 2 - 10)
    .attr("y", height * 1.1)
    .attr("text-anchor", "middle")
    .style("font-size", "18px")
    .style("font-family", "Helvetica")
    .style("font-weight", "bold")
    .text("Total Pitstops Count for Selected IDs");

d3.csv("data/pit_stops.csv").then(function (data) {
    data.forEach(function (d) {
        d.stop = +d.stop; // Assuming the column name for pitstops is "Pitstops"
    });

    // Filter data based on desired IDs
    var filteredData = data.filter(function (d) {
        return desiredIDs.includes(d.raceId);
    });

    // Aggregate pitstops for each race
    var racePitstops = {};

    filteredData.forEach(function (d) {
        if (!racePitstops[d.raceId]) {
            racePitstops[d.raceId] = 0;
        }
        racePitstops[d.raceId] += d.stop;
    });

    // Count pitstops in each category
    var pitstopCounts = {
        '0-29': 0,
        '30-59': 0,
        '60-89': 0,
        '90+': 0
    };

    Object.values(racePitstops).forEach(function (totalPitstops) {
        if (totalPitstops >= 0 && totalPitstops <= 29) {
            pitstopCounts['0-29']++;
        } else if (totalPitstops >= 30 && totalPitstops <= 59) {
          pitstopCounts['30-59']++;
        } else if (totalPitstops >= 60 && totalPitstops <= 89) {
          pitstopCounts['60-89']++;
        } else {
            pitstopCounts['90+']++;
        }
    });

    // Create an array of objects for the bar chart
    var barData = Object.keys(pitstopCounts).map(function (key) {
        return { category: key, count: pitstopCounts[key] };
    });

    // Define a custom color for the bars
    var barColor = d3.scaleOrdinal()
        .domain(barData.map(function (d) { return d.category; }))
        .range(["#FF00FF", "#FF00FF", "#FF00FF"]);

    x.domain(barData.map(function (d) { return d.category; }));
    y.domain([0, d3.max(barData, function (d) { return d.count; })]);

    svg.selectAll(".bar")
        .data(barData)
        .enter().append("rect")
        .attr("class", "bar")
        .attr("x", function (d) { return x(d.category); })
        .attr("width", x.bandwidth())
        .attr("y", function (d) { return y(d.count); })
        .attr("height", function (d) { return height - y(d.count); })
        .attr("fill", function (d) { return barColor(d.category); });

    svg.append("g")
        .attr("transform", "translate(0," + height + ")")
        .call(d3.axisBottom(x));

    svg.append("g")
        .call(d3.axisLeft(y));

    // Adjust font size for x-axis tick labels
    svg.selectAll(".tick text")
        .style("font-size", "15px");
});

</script>



<script type="module">
  // set the dimensions and margins of the graph
var margin = {top: 20, right: 20, bottom: 30, left: 40},
    width = 960/2 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

// set the ranges
var x = d3.scaleBand()
          .range([0, width])
          .padding(0.8);
var y = d3.scaleLinear()
          .range([height, 0]);
          
// append the svg object to the body of the page
// append a 'group' element to 'svg'
// moves the 'group' element to the top left margin
var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", 
          "translate(" + margin.left + "," + margin.top + ")");

  // get the data
  d3.csv("./data/pit_stops_total.csv").then(function(data) {
  // Define the range of valid race_id values
  var validRaceIds = ['0', '1', '2'];

  // Filter the data based on validRaceIds
  var filteredData = data.filter(function(d) {
      return d.raceId;
  });

  data.forEach(function(d) {
    d.stop = + d.stop;
  });
  // Scale the range of the data in the domains using the filtered data
  x.domain(filteredData.map(function(d) { return d.raceId; }));
  y.domain([0, d3.max(filteredData, function(d) { return d.stop; })]);

  // append the rectangles for the bar chart
  svg.selectAll(".bar")
      .data(data)
    .enter().append("rect")
      .attr("class", "bar")
      .attr("x", function(d) { return x(d.raceId); })
      .attr("width", x.bandwidth())
      .attr("y", function(d) { return y(d.stop); })
      .attr("height", function(d) { return height - y(d.stop); });

  // add the x Axis
  svg.append("g")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x));

  // add the y Axis
  svg.append("g")
      .call(d3.axisLeft(y));

});

</script>


<script type="module">
  import {
    forceSimulation,
    forceCollide,
    forceX,
  } from "https://cdn.jsdelivr.net/npm/d3-force@3/+esm";

  const nodes = [{}, {}];
  const simulation = forceSimulation(nodes)
    .force("x", forceX())
    .force("collide", forceCollide(5))
    .on("tick", () => console.log(nodes[0].x));
</script>
